import{e as V,A as H,_ as W,d as ee,a as x,u as $e,c as Ae,g as De}from"./index-Dv-qMdo4.js";import{V as Te,g as Ie}from"./ViewNoteMarkdown-Dx3lLV6h.js";import{D as Oe,V as Ce,A as Ve,g as Pe}from"./AddNotebookForm-CjOWMak8.js";import{d as j,f as K,U as f,V as T,F as L,m as C,Z as S,q as l,X as O,u as R,a as h,t as Re,ab as te,W as D,N as oe,_ as q,aa as re,$ as se,M as Me,ac as xe,Y as z,D as ze}from"./vue-vendor-DGfeFLTS.js";import{V as Q,F as Le}from"./FooterView-B3LtViKB.js";import{V as ae,b as ne}from"./VCard-DjaoZtbU.js";import"./vuetify-vendor-ZlQH_a5_.js";import"./ErrorAlert-BgoxP2kL.js";const Be={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},Fe=Be,He=H,je=async(y,m)=>{let n;try{const s={notebookID:m};if(n=await fetch(Fe.VITE_API_ENDPOINT+"api/data/delete-notebook",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(s)}),n.status===404)throw new Error(`${n.url} Not Found.`)}catch(s){return{error:V(s)}}let r;try{if(r=await n.json(),r===null)return{error:`${He.NOTEBOOK_DELETE_ERROR}`}}catch(s){return{error:V(s)}}return r.error?{error:r.error}:r},Ue={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},Je=Ue,We=H,Ke=async(y,m)=>{let n;const r={note_ids:m};try{if(n=await fetch(Je.VITE_API_ENDPOINT+"api/data/delete-notes",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(r)}),n.status===404)throw new Error(`${n.url} Not Found.`)}catch(a){return{error:V(a)}}let s;try{if(s=await n.json(),s===null)return{error:`${We.NOTES_DELETE_ERROR}`}}catch(a){return{error:V(a)}}return s.error?{error:s.error}:s},qe={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},Ge=qe,Xe=H,Ye=async(y,m,n,r,s)=>{let a;const N={notebookID:m,notebookName:n,notebookCover:r,notebookUpdated:s};try{if(a=await fetch(Ge.VITE_API_ENDPOINT+"api/data/edit-notebook",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(N)}),a.status===404)throw new Error(`${a.url} Not Found.`)}catch(p){return{error:V(p)}}let v;try{if(v=await a.json(),v===null)return{error:`${Xe.NOTES_ERROR}`}}catch(p){return{error:V(p)}}return v.error?{error:v.error}:v},Ze={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},Qe=Ze,et=H,tt=async(y,m,n)=>{let r;const s={notebookID:m,notebookUpdated:n};try{if(r=await fetch(Qe.VITE_API_ENDPOINT+"api/data/edit-notebook-date",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(s)}),r.status===404)throw new Error(`${r.url} Not Found.`)}catch(N){return{error:V(N)}}let a;try{if(a=await r.json(),a===null)return{error:`${et.NOTEBOOK_UPDATE_DATE_ERROR}`}}catch(N){return{error:V(N)}}return a.error?{error:a.error}:a},ot={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},rt=ot,st=H,at=async(y,m)=>{let n;try{if(n=await fetch(rt.VITE_API_ENDPOINT+`api/data/notes/${m}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`}}),n.status===404)throw new Error(`${n.url} Not Found.`)}catch(s){return{error:V(s)}}let r;try{if(r=await n.json(),r===null)return{error:`${st.NOTES_ERROR}`}}catch(s){return{error:V(s)}}return r.error?{error:r.error}:r},nt={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},lt=nt,it=H,ut=async(y,m,n,r)=>{let s;const a={notes:n,notebookID:m,latestUpdatedNote:r};try{if(s=await fetch(lt.VITE_API_ENDPOINT+"api/data/move-notes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(a)}),s.status===404)throw new Error(`${s.url} Not Found.`)}catch(v){return{error:V(v)}}let N;try{if(N=await s.json(),N===null)return{error:`${it.NOTES_ERROR}`}}catch(v){return{error:V(v)}}return N.error?{error:N.error}:N},ct={key:1,class:"box"},dt={class:"viewnote_content viewnote_thumb"},_t=j({__name:"ViewNoteThumb",props:{text:{}},setup(y){const n=Re(y,"text"),r=h(!1);let s,a;const N=()=>{a=setTimeout(()=>{r.value=!0,clearTimeout(a)},600)};return K(n,v=>{s=v,N()},{deep:!0,immediate:!0}),(v,p)=>(f(),T(L,null,[r.value?S("",!0):(f(),T(L,{key:0},[C(Q,{type:"list-item"}),C(Q,{type:"list-item"})],64)),r.value?(f(),T("div",ct,[l("article",dt,[r.value?(f(),O(Te,{key:0,viewText:R(s),disableLinks:!0},null,8,["viewText"])):S("",!0)])])):S("",!0)],64))}}),vt=W(_t,[["__scopeId","data-v-1fadc4a6"]]),ft={class:"notes_list"},pt={class:"thumb_outer"},bt={class:"thumb_outer_link"},mt=["id","onClick"],Nt={class:"thumb_image"},ht={class:"date_format date_format_notes"},kt={key:0,class:"thumb_select_outer"},yt={class:"thumb_select"},Et=["id","value"],wt=j({__name:"NoteList",props:{notes:{},onNotesSelected:{type:Function},onNotesEdit:{type:Boolean},onClearNotesEdit:{type:Boolean}},setup(y){const m=y,n=Oe,r=h(m.notes),s=h([]),a=h({selected:[]}),N=h({});if(K(a,u=>{m.onNotesSelected(u)}),m.notes){const u=m.notes;if(u){r.value=u;let c=[];u.forEach(E=>{let _={id:E._id,selected:!1};return c.push(_),c}),s.value=c}}const v=(u,c)=>{let _=[...s.value];const d=s.value?.findIndex($=>$.id===u);d>=0&&_.length>0&&(_[d].selected=c),s.value=_;let o={selected:[]};s.value?.forEach($=>{$.selected&&o.selected.push($.id)}),a.value=o},p=u=>{const c=u.currentTarget,{checked:E}=c,_=c.value;v(_,E)},b=u=>{const c=N.value[u];let{checked:E}=c;const _=c.value;c.checked=!E,E=c.checked,v(_,E)},i=u=>{m.onNotesEdit&&u.preventDefault()},M=u=>{m.onNotesEdit&&b(u)};return(u,c)=>{const E=q("router-link");return f(),T("ul",ft,[(f(!0),T(L,null,te(r.value,_=>(f(),T("li",{class:"notebook_list_bg",key:_._id},[l("div",pt,[C(E,{onClick:i,to:"/notebook/"+_.notebook+"/"+_._id,class:"thumb_outer_link"},{default:D(()=>[l("div",bt,[l("div",{id:_._id,class:"edit_link",onClick:d=>M(_._id)},[C(ae,{class:"note_list_card"},{default:D(()=>[C(ne,{class:"cardcontent"},{default:D(()=>[l("div",Nt,[C(vt,{text:_.note},null,8,["text"])]),l("div",ht,oe(R(n)(_.updatedAt)),1)]),_:2},1024)]),_:2},1024)],8,mt)])]),_:2},1032,["to"]),y.onNotesEdit?(f(),T("div",kt,[l("div",yt,[l("input",{ref_for:!0,ref:d=>{d&&(N.value[_._id]=d)},id:`input_${_._id}`,type:"checkbox",name:"Status",value:_._id,onChange:c[0]||(c[0]=d=>p(d))},null,40,Et)])])):S("",!0)])]))),128))])}}}),gt=W(wt,[["__scopeId","data-v-5df8454c"]]),St={class:"dialogue_container"},$t={class:"form"},At={class:"control"},Dt=["value"],Tt={class:"button_row"},It={class:"action"},Ot={class:"move"},Ct={class:"cancel"},Vt=j({__name:"SelectNotebookForm",props:{notebooks:{},onCancel:{type:Function},moveNotes:{type:Function}},setup(y){const m=ee(),{btnSize:n}=re(m),r=y,s=se(),a=h(!0),N=s.params.notebookId,v=h(""),p=h(!1),b=h(null),i=h({error_state:!1,error_severity:"",message:""}),M=d=>{const o=r.notebooks.findIndex($=>$._id===d);return r.notebooks[o]},u=d=>(d.forEach(o=>{o.updatedAt==="No date"&&(o.updatedAt="December 17, 1995 03:24:00"),o.createdAt==="No date"&&(o.createdAt="December 17, 1995 03:24:00")}),d.sort((o,$)=>o.updatedAt!==void 0&&$.updatedAt!==void 0?new Date(o.updatedAt)>new Date($.updatedAt)?1:-1:o.updatedAt!==void 0?1:-1).reverse(),d),c=d=>{d.preventDefault(),d.stopPropagation(),i.value.error_state&&_(),a.value=!1,r.onCancel()},E=async d=>{if(d.preventDefault(),d.stopPropagation(),i.value.error_state&&_(),M(v.value),!v.value){p.value=!1;return}r.moveNotes(v.value),a.value=!1,r.onCancel()},_=()=>{p.value=!0,i.value={error_state:!1,error_severity:"",message:""}};if(K(v,d=>{d===""||d==="default"?p.value=!1:p.value=!0}),r.notebooks){let d=u(r.notebooks);b.value=d}return(d,o)=>{const $=q("ErrorAlert");return f(),O(Ce,{modelValue:a.value,"onUpdate:modelValue":o[3]||(o[3]=g=>a.value=g),width:"auto"},{default:D(()=>[C(ae,null,{default:D(()=>[C(ne,null,{default:D(()=>[l("div",St,[o[8]||(o[8]=l("h2",{class:"dialogue-title"},"Move to Notebook",-1)),l("form",$t,[l("div",At,[o[5]||(o[5]=l("label",{for:"new-notebook-cover"},"Name",-1)),Me(l("select",{name:"notebooks",id:"notebooks","onUpdate:modelValue":o[0]||(o[0]=g=>v.value=g)},[o[4]||(o[4]=l("option",{disabled:"",value:""},"Select a notebook...",-1)),(f(!0),T(L,null,te(b.value,g=>(f(),T(L,null,[g._id!==R(N)?(f(),T("option",{key:g._id,value:g._id},oe(g.notebook_name),9,Dt)):S("",!0)],64))),256))],512),[[xe,v.value]])])]),l("div",Tt,[l("div",It,[l("div",Ot,[C(x,{size:R(n),disabled:!p.value,color:"secondary","aria-label":"Move Note button",class:"contained medium",onClick:o[1]||(o[1]=g=>E(g))},{default:D(()=>[...o[6]||(o[6]=[z(" Move Note ",-1)])]),_:1},8,["size","disabled"])]),l("div",Ct,[C(x,{size:R(n),color:"secondary","aria-label":"Cancel button",class:"contained medium",onClick:o[2]||(o[2]=g=>c(g))},{default:D(()=>[...o[7]||(o[7]=[l("span",{class:"icon_text"},[l("span",{class:"material-symbols-outlined button_icon white"}," cancel "),z(" Cancel ")],-1)])]),_:1},8,["size"])])])]),i.value.error_state?(f(),O($,{key:0,error_severity:i.value.error_severity,error_state:i.value.error_state,message:i.value.message},null,8,["error_severity","error_state","message"])):S("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Pt=W(Vt,[["__scopeId","data-v-9772e13a"]]),Rt={class:"page_scrollable_header_breadcrumb_footer_list"},Jt=j({__name:"NotebookPage",setup(y){const m=ee(),{btnSize:n}=re(m),r=$e(),s=Ae(),a=De();r.$subscribe((e,t)=>{X(t.authContext)}),a.$subscribe((e,t)=>{t.editing&&pe()});const N=ze(),p=se().params.notebookId;let b;const i=h(null),M=h(!1),u=h(!1),c=h(!1),E=h(!1),_=h(null),d=h(null),o=h(null),$=h(!1),g=h(!1),B=h(!1),U=h(!1);let G;const le=()=>{M.value&&(G=setTimeout(()=>{u.value=!0,clearTimeout(G)},100)),u.value||ie(),c.value||ue(),E.value||ce()},X=e=>{e.loading,b=e.token},A=e=>{s.ShowNotification({notification:{n_status:"error",title:"Error!",message:e}})},Y=e=>(e.forEach(t=>{t.updatedAt==="No date"&&(t.updatedAt="December 17, 1995 03:24:00")}),e.sort((t,k)=>t.updatedAt!==void 0&&k.updatedAt!==void 0?new Date(t.updatedAt)>new Date(k.updatedAt)?1:-1:t.updatedAt!==void 0?1:-1).reverse(),e),ie=async()=>{if(!u.value&&b&&p){M.value=!1,u.value=!1;try{const e=await at(b,p);if(u.value=!0,e.error){A(`${e.error}`);return}if(e.success){const t=Y(e.notes);i.value=t,M.value=!0}}catch(e){A(`${e}`),M.value=!0;return}}},ue=async()=>{if(!c.value&&b&&p){c.value=!1;try{const e=await Ie(b,p);if(c.value=!0,e.error){A(`${e.error}`);return}e.success&&(_.value=e.notebook,a.edited=e.notebook)}catch(e){A(`${e}`),c.value=!0;return}}},ce=async()=>{if(!E.value&&b){E.value=!1;try{const e=await Pe(b);if(E.value=!0,e.error){A(`${e.error}`);return}e.success&&(d.value=e.notebooks)}catch(e){A(`${e}`),E.value=!0;return}}},de=e=>{o.value=e},_e=()=>{$.value=!0},ve=()=>{$.value=!1},fe=()=>{g.value=!1,a.editing=!1},pe=()=>{g.value=!0},be=()=>{N.push(`/notebook/${p}/create-note`)},me=()=>{B.value=!0,U.value=!1},Ne=()=>{let e={selected:[]};o.value={...o,selected:e.selected}},J=()=>{B.value=!1,U.value=!0,Ne()},Z=(e,t)=>{ke(e,t)},he=async()=>{let e;if(b&&o.value!==null&&o.value!==void 0&&o.value?.selected!==null){e=o.value.selected;try{const t=await Ke(b,e);if(c.value=!0,t.error){A(`${t.error}`);return}if(t.success){let k;const I=i.value[0].updatedAt;let w=o.value.selected.length;if(w&&w>0&&i.value)for(;w--;){const P=i.value.findIndex(F=>F._id===o.value.selected[w]);P>=0&&i.value.splice(P,1)}if(i.value&&i.value.length>0&&(k=i.value[0].updatedAt),k!==void 0&&p!==void 0&&I&&new Date(k).getTime()!==new Date(I).getTime()){let P=String(p);Z(P,k)}J()}}catch(t){A(`${t}`);return}}},ke=async(e,t)=>{if(b&&e&&t)try{const k=await tt(b,e,t);if(k.error){A(`${k.error}`);return}}catch(k){A(`${k}`);return}},ye=async()=>{const e=_.value._id;if(b&&e&&e.length>0)try{const t=await je(b,e);if(t.error){A(`${t.error}`);return}t.success&&N.push("/notebooks")}catch(t){A(`${t}`);return}},Ee=async(e,t,k,I)=>{if(b&&e&&t&&k&&I)try{const w=await Ye(b,e,t,k,I);if(w.error){A(`${w.error}`);return}w.success&&(_.value=w.notebook_edited,g.value=!1,a.editing=!1,a.edited=w.notebook_edited)}catch(w){A(`${w}`);return}},we=e=>{let t=[];for(const w in e)if(i.value!==null){var k=i.value.filter(P=>P._id===e[w]);t.push(k[0])}return Y(t)[0].updatedAt},ge=async e=>{let t;if(b&&e&&o.value!==null&&o.value!==void 0&&o.value?.selected!==null){t=o.value.selected;const k=we(t);try{const I=await ut(b,e,t,k);if(I.error){A(`${I.error}`);return}if(I.success){let w,P=o.value.selected.length;if(P&&P>0&&i.value)for(;P--;){const F=i.value.findIndex(Se=>Se._id===o.value.selected[P]);F>=0&&i.value.splice(F,1)}if(i.value&&i.value.length>0&&(w=i.value[0].updatedAt),w!==void 0&&p!==void 0){let F=String(p);Z(F,w)}$.value=!1,J()}}catch(I){A(`${I}`);return}}};return(async()=>{const e=await r.getAuth();e.value!==null&&(X(e.value),le())})(),(e,t)=>{const k=q("LoadingScreen");return f(),T(L,null,[!c.value||!u.value?(f(),O(k,{key:0})):S("",!0),l("div",Rt,[c.value&&u.value&&_.value&&i.value?(f(),T(L,{key:0},[u.value&&_.value&&i.value!==null?(f(),O(gt,{key:0,notes:i.value,onNotesSelected:de,onNotesEdit:B.value,onClearNotesEdit:U.value},null,8,["notes","onNotesEdit","onClearNotesEdit"])):S("",!0),$.value&&d.value?(f(),O(Pt,{key:1,notebooks:d.value,moveNotes:ge,onCancel:ve},null,8,["notebooks"])):S("",!0),g.value?(f(),O(Ve,{key:2,method:"edit",notebook:_.value,editNotebook:Ee,onCancel:fe},null,8,["notebook"])):S("",!0)],64)):S("",!0)]),C(Le,null,{default:D(()=>[c.value&&u.value&&!B.value?(f(),O(x,{key:0,size:R(n),rounded:"xl",color:"secondary","aria-label":"Add note button",class:"contained medium breadcrumb_edit_fab button_fab",onClick:be},{default:D(()=>[...t[0]||(t[0]=[l("span",{class:"icon_text"},[l("span",{class:"material-symbols-outlined button_icon white"}," note_add "),z(" Add Note ")],-1)])]),_:1},8,["size"])):S("",!0),c.value&&u.value&&!B.value&&i.value&&i.value.length>0?(f(),O(x,{key:1,size:R(n),rounded:"xl",color:"secondary","aria-label":"Edit Notes button",class:"contained medium breadcrumb_edit_fab button_fab",onClick:me},{default:D(()=>[...t[1]||(t[1]=[l("span",{class:"icon_text"},[l("span",{class:"material-symbols-outlined button_icon white"}," edit "),z(" Edit Notes ")],-1)])]),_:1},8,["size"])):S("",!0),c.value&&u.value&&i.value&&i.value.length<1?(f(),O(x,{key:2,size:R(n),rounded:"xl",color:"secondary","aria-label":"Delete Notebook button",class:"contained medium breadcrumb_edit_fab button_fab",onClick:ye},{default:D(()=>[...t[2]||(t[2]=[l("span",{class:"icon_text"},[l("span",{class:"material-symbols-outlined button_icon white"}," delete "),z(" Delete Notebook ")],-1)])]),_:1},8,["size"])):S("",!0),c.value&&u.value&&B.value&&o.value&&o.value.selected.length>0?(f(),T(L,{key:3},[C(x,{rounded:"xl",size:R(n),color:"secondary","aria-label":"Delete Note button",class:"contained medium breadcrumb_edit_fab button_fab",onClick:he},{default:D(()=>[...t[3]||(t[3]=[l("span",{class:"icon_text"},[l("span",{class:"material-symbols-outlined button_icon white"}," delete "),z(" Delete ")],-1)])]),_:1},8,["size"]),d.value&&d.value.length>1?(f(),O(x,{key:0,size:R(n),rounded:"xl",color:"secondary","aria-label":"Move Note button",class:"contained medium breadcrumb_edit_fab button_fab",onClick:_e},{default:D(()=>[...t[4]||(t[4]=[l("span",{class:"icon_text"},[l("span",{class:"material-symbols-outlined button_icon white symbol_size"}," flip_to_front "),z(" Move ")],-1)])]),_:1},8,["size"])):S("",!0)],64)):S("",!0),c.value&&u.value&&B.value?(f(),O(x,{key:4,size:R(n),rounded:"xl",color:"secondary","aria-label":"Cancel Note button",class:"contained medium breadcrumb_edit_fab button_fab",onClick:J},{default:D(()=>[...t[5]||(t[5]=[l("span",{class:"icon_text"},[l("span",{class:"material-symbols-outlined button_icon white"}," cancel "),z(" Cancel ")],-1)])]),_:1},8,["size"])):S("",!0)]),_:1})],64)}}});export{Jt as default};
