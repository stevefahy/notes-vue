import{e as x,A as M,_ as V,d as H,u as F,c as P,a as U}from"./index-Dv-qMdo4.js";import{D as j,A as q,g as J}from"./AddNotebookForm-CjOWMak8.js";import{d as T,a as h,U as s,V as u,m,W as L,q as k,n as K,u as N,Z as _,F as y,N as O,I as W,_ as I,X as g,aa as D,ab as X,Y}from"./vue-vendor-DGfeFLTS.js";import{b as Z,V as G}from"./VCard-DjaoZtbU.js";import{V as E,F as Q}from"./FooterView-B3LtViKB.js";import"./vuetify-vendor-ZlQH_a5_.js";import"./ErrorAlert-BgoxP2kL.js";const ee={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},oe=ee,te=M,se=async(b,a,d)=>{let t;try{const r={notebookName:a,notebookCover:d};if(t=await fetch(oe.VITE_API_ENDPOINT+"api/data/addnotebook",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify(r)}),t.status===404)throw new Error(`${t.url} Not Found.`)}catch(r){return{error:x(r)}}let o;try{if(o=await t.json(),o===null)return{error:`${te.NOTEBOOK_CREATE_ERROR}`}}catch(r){return{error:x(r)}}return o.error?{error:o.error}:o},ne={class:"notebooks_list_bg"},ae={class:"notebooks_list_outer"},re={key:0},ce={class:"notebooks_list_right"},ie={class:"date_format"},ue=T({__name:"NotebookListHtml",props:["notebookLoaded","notebook_item"],setup(b){const a=b,d=h(a.notebook_item),t=a.notebookLoaded,o=j;return(r,l)=>(s(),u("li",ne,[m(G,null,{default:L(()=>[m(Z,{class:"cardcontent"},{default:L(()=>[k("div",ae,[k("div",{class:K(["notebooks_list_left",N(t)?"tab_"+d.value.notebook_cover:""])},[N(t)?_("",!0):(s(),u("div",re,[m(E,{type:"card",height:"10px"})]))],2),k("div",ce,[N(t)?_("",!0):(s(),u(y,{key:0},[m(E,{type:"list-item"}),m(E,{type:"list-item"})],64)),N(t)?(s(),u(y,{key:1},[k("div",null,O(d.value.notebook_name),1),k("div",ie,[k("div",null,O(N(o)(b.notebook_item.updatedAt)),1)])],64)):_("",!0)])])]),_:1})]),_:1})]))}}),B=V(ue,[["__scopeId","data-v-52d8a28f"]]),de=T({__name:"NotebookListItem",props:{notebook_item:{}},setup(b){const a=h(!1);W(()=>{t()});let d;const t=()=>{d=setTimeout(()=>{a.value=!0,clearTimeout(d)},300)};return(o,r)=>{const l=I("router-link");return s(),u(y,null,[a.value?_("",!0):(s(),g(B,{key:0,notebook_item:"null",notebookLoaded:a.value},null,8,["notebookLoaded"])),a.value?(s(),g(l,{key:1,to:"/notebook/"+b.notebook_item._id},{default:L(()=>[m(B,{notebook_item:b.notebook_item,notebookLoaded:a.value},null,8,["notebook_item","notebookLoaded"])]),_:1},8,["to"])):_("",!0)],64)}}}),le=V(de,[["__scopeId","data-v-1d46dc4f"]]),_e={key:0},be={key:1},ke={class:"notebooks_list"},me=T({__name:"NotebooksList",props:{error:{},success:{type:Boolean},notebooks:{}},setup(b){const a=H(),{btnSize:d}=D(a),t=b,o=F(),r=P(),{authContext:l}=D(o),A=h(!1),f=h([]),S=h(!1);let C;o.$subscribe((n,p)=>{e(p.authContext)});const e=n=>{n.loading,C=n.token,v(t)},v=n=>{if(n&&n.success&&n.notebooks){const p=n.notebooks;f.value=p,S.value=!0}n&&n.error&&c(n.error)},c=n=>{r.ShowNotification({notification:{n_status:"error",title:"Error!",message:n}})},w=()=>{A.value=!0},R=()=>{A.value=!1},z=async(n,p)=>{if(C)try{const i=await se(C,n,p);if(i.error){c(`${i.error}`);return}if(i.success){const $=f.value;f.value=[{_id:i.notebook._id,notebook_name:i.notebook.notebook_name,notebook_cover:i.notebook.notebook_cover,updatedAt:i.notebook.updatedAt,createdAt:i.notebook.createdAt},...$]}}catch(i){c(`${i}`);return}};return l.value.success&&e(l.value),(n,p)=>{const i=I("LoadingScreen");return s(),u(y,null,[S.value?_("",!0):(s(),u("div",_e,[m(i)])),f.value?(s(),u("div",be,[k("ul",ke,[(s(!0),u(y,null,X(f.value,$=>(s(),g(le,{key:$._id,notebook_item:$},null,8,["notebook_item"]))),128)),A.value?(s(),g(q,{key:0,method:"create",addNotebook:z,onCancel:R})):_("",!0)])])):_("",!0),m(Q,null,{default:L(()=>[f.value?(s(),g(U,{key:0,size:N(d),rounded:"xl",color:"secondary","aria-label":"Add notebook button",class:"contained medium breadcrumb_edit_fab button_fab",onClick:w},{default:L(()=>[...p[0]||(p[0]=[k("span",{class:"icon_text"},[k("span",{class:"material-symbols-outlined button_icon white"}," add_circle "),Y(" Add Notebook ")],-1)])]),_:1},8,["size"])):_("",!0)]),_:1})],64)}}}),fe=V(me,[["__scopeId","data-v-42ab6863"]]),pe={key:0},ve={class:"page_scrollable_header_breadcrumb_footer_list"},he={key:0},we=T({__name:"NotebooksPage",setup(b){const a=F(),d=P(),t=h(!1),o=h({success:!1,notebooks:[]});let r;a.$subscribe((e,v)=>{S(v.authContext)});const l=e=>{d.ShowNotification({notification:{n_status:"error",title:"Error!",message:e}})},A=async()=>{if(!t.value&&r)try{const e=await J(r);if(e.error){l(`${e.error}`);return}e.success&&(o.value=e,f())}catch(e){l(`${e}`);return}},f=async()=>{const e=o.value.notebooks,v=o.value.error;e&&e.length>0&&(e.map(c=>(c.updatedAt==="No date"&&(c.updatedAt="December 17, 1995 03:24:00"),c)),e.sort((c,w)=>c.updatedAt!==void 0&&w.updatedAt!==void 0?new Date(c.updatedAt)>new Date(w.updatedAt)?1:-1:c.updatedAt!==void 0?1:-1).reverse(),o.value={success:!0,notebooks:e},t.value=!0),v&&l(v)},S=e=>{e.loading,r=e.token};return(async()=>{const e=await a.getAuth();e.value!==null&&(S(e.value),A())})(),(e,v)=>{const c=I("LoadingScreen");return s(),u(y,null,[t.value?_("",!0):(s(),u("div",pe,[m(c)])),k("div",ve,[t.value&&o.value.notebooks?(s(),u("div",he,[m(fe,{error:o.value.error,success:o.value.success,notebooks:o.value.notebooks},null,8,["error","success","notebooks"])])):_("",!0)])],64)}}});export{we as default};
